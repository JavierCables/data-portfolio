<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/svg+xml" href="../assets/img/favicon.svg" />
  <title>Detailed Report — For More Information</title>
  <link rel="stylesheet" href="../assets/css/styles.css" />
  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.7.0/fonts/remixicon.css" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/base16/dracula.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>

  <style>
    /* Cambiar fondo del bloque de código */
    pre code.hljs {
      background: #36312c;
      color: #ebd1b7;
      border-radius: 7px;
      padding: 1.2rem;
      display: block;
    }
    .hljs-keyword { color: #95cc5e }
    .hljs-string  { color: #ee6018 }
    .hljs-number  { color: #f8bb39 }
    .hljs-comment { color: #7a7267; font-style: italic; }
    .hljs-meta { color: #f8bb39; }
    .hljs-built_in { color: #95cc5e; }
    .hljs-title.function_ { color: #ee6018; }
    .hljs-literal { color: #f8bb39; }
    .hljs-title.class_ { color: #ee1895; }
    .hljs-variable { color: #ee1895; }
    .hljs-params { color: #f8bb39; }
    .hljs-type { color: #f8bb39; }
  </style>
</head>

<body>
  <div id="root">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="header-title">
          <img src="../assets/img/logo.svg" alt="Atom icon" class="header-logo" />
          <a href="../index.html">JAVIER CABLES PORTFOLIO</a>
          <span class="separator">/</span>
          <a href="../projects/project-netflix-content-analysis.html" data-i18n="properties.title-5">Netflix Movies and TV Shows Data Analysis</a>
          <span class="separator">/</span>
          <span class="current" data-i18n="header.report">Detailed Report</span>
        </div>
        <div class="header-actions">
          <button class="dark-mode-toggle" id="themeToggle" aria-label="Toggle dark mode">
            <i class="ri-moon-fill"></i>
          </button>
          <button class="change-language" id="langToggle" data-i18n="button.language">Spanish</button>
        </div>
      </div>
    </header>

    <!-- Hero Image -->
    <div class="project-hero">
        <img src="../assets/img/portfolio-5.jpg" alt="Vinyl Record">
    </div>

    <main class="main-content">
      <!-- Report Header -->
      <div class="project-header">
          <i class="ri-movie-2-fill"></i>
          <h1 data-i18n="report.title">Detailed Report — For More Information</h1>
      </div>

      <!-- Navigation Bar -->
      <a href="../index.html" class="navigation-card">
          <i class="ri-arrow-left-fill"></i>
          <p data-i18n="navigation.homepage">Homepage</p>
      </a>

      <!-- Table of Contents Callout -->
      <div class="callout-box">
        <div class="callout-header">
          <i class="ri-list-check"></i>
          <h3 data-i18n="toc.title">Table of Contents</h3>
        </div>
    
        <div class="callout-content">
          <ul class="toc-list">
            <li><a href="#project-summary" data-i18n="section.summary">Project Summary</a></li>
            <li><a href="#project-environment" data-i18n="section.environment">Project Environment</a></li>
            <li><a href="#scope-steps" data-i18n="section.scope_steps">Scope & Project Steps</a></li>
            <li><a href="#data-sources" data-i18n="section.data_sources">Data Sources & Data Gathering</a></li>
            <li><a href="#schema" data-i18n="sub.schema">Schema</a></li>
            <li><a href="#solutions" data-i18n="section.solutions">Solutions</a></li>
          </ul>
        </div>
      </div>

      <!-- Collapsible Sections -->
      <div class="section accordion-level-1" id="project-summary">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="section.summary">Project Summary</p>
        </div>

        <div class="section-content">
          <p data-i18n="section.summary.text-5">Advanced <span>SQL</span> analysis of 8,807 Netflix titles, solving 15 complex business problems. The methodology involved setting up a <span>PostgreSQL</span> database, defining the schema, manipulating complex text fields using array and string functions (<span>UNNEST</span>, <span>STRING_TO_ARRAY</span>), and applying Window Functions.</p>
        </div>
      </div>

      <div class="section accordion-level-1" id="project-environment">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="section.environment">Project Environment</p>
        </div>

        <div class="section-content">
          <p data-i18n="section.environment.text-5">The core tools used were <span>PostgreSQL</span> for the database and querying, with <span>PG Admin 4</span> serving as the management interface. Initial data inspection was conducted in <span>Excel</span>. The final project was published on <span>GitHub</span>.</p>
        </div>
      </div>

      <div class="section accordion-level-1" id="scope-steps">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="section.scope_steps">Scope & Project Steps</p>
        </div>

        <div class="section-content">
          <div class="section accordion-level-2" id="schema-1">
              <div class="section-header">
                <i class="ri-arrow-right-s-fill"></i>
                <span data-i18n="sub.scope">Scope</span>
              </div>
  
              <div class="section-content">
                <p data-i18n="sub.scope.text-5">Solve 15 medium-to-advanced business problems using complex <span>SQL</span> queries on 8,807 Netflix records.</p>
              </div>
          </div>

          <div class="section accordion-level-2" id="schema-1">
              <div class="section-header">
                  <i class="ri-arrow-right-s-fill"></i>
                  <span data-i18n="sub.steps">Project Steps</span>
              </div>
  
              <div class="section-content">
                <li><p data-i18n="sub.steps.text-5.1">Acquired the 'Netflix movies and TV shows' dataset from the <span>Kaggle</span> platform</p></li>
                <li><p data-i18n="sub.steps.text-5.2">Performed initial data exploration in <span>Excel</span> to verify column types and lengths</p></li>
                <li><p data-i18n="sub.steps.text-5.3">Created the database and defined the table schema in <span>PostgreSQL</span> using <span>PG Admin 4</span></p></li>
                <li><p data-i18n="sub.steps.text-5.4">Defined precise data types, calculating <span>VARCHAR</span> limits for long text columns</p></li>
                <li><p data-i18n="sub.steps.text-5.5">Imported the data, addressing import failures by correcting the <span>VARCHAR</span> length</p></li>
                <li><p data-i18n="sub.steps.text-5.6">Confirmed successful import, verifying the existence of 8,807 total records</p></li>
                <li><p data-i18n="sub.steps.text-5.7">Developed complex <span>SQL</span> solutions for 15 specified business problems</p></li>
                <li><p data-i18n="sub.steps.text-5.8">Used advanced techniques like <span>UNNEST</span> to split multi-value columns (countries, cast)</p></li>
                <li><p data-i18n="sub.steps.text-5.9">Published the documented project and code solutions on a <span>GitHub</span> repository</p></li>                
              </div>
          </div>
        </div>
      </div>

      <div class="section accordion-level-1" id="data-sources">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="section.data_sources">Data Sources & Data Gathering</p>
        </div>

        <div class="section-content">
          <div class="section accordion-level-2" id="schema-1">
              <div class="section-header">
                <i class="ri-arrow-right-s-fill"></i>
                <span data-i18n="sub.data_sources">Data Sources</span>
              </div>
  
              <div class="section-content">
                <p data-i18n="sub.data_sources.text-5">The dataset, titled 'Netflix movies and TV shows' was downloaded from <span>Kaggle</span>. It contains 8,808 records (titles) with details on show ID, type (movie/TV show), director, cast, country, release date, rating, duration, genre, and descriptions.</p>
              </div>
          </div>

          <div class="section accordion-level-2" id="schema-1">
              <div class="section-header">
                  <i class="ri-arrow-right-s-fill"></i>
                  <span data-i18n="sub.data_gathering">Data Gathering</span>
              </div>
  
              <div class="section-content">
                <p data-i18n="sub.data_gathering.text-5.1">The data gathering process began with locating and downloading the required dataset, 'Netflix movies and TV shows' from the <span>Kaggle</span> website. This dataset was provided as a compressed (zipped) file, which was then unzipped. Link <a href="https://www.kaggle.com/datasets/shivamb/netflix-shows">[HERE]</a>.</p>
                <p data-i18n="sub.data_gathering.text-5.2">Following the download, the file was opened in <span>Excel</span> for a critical initial exploration. This phase was essential for inspecting the characteristics of the data, especially the potential lengths of text fields such as title, director, cast, and descriptions. The check revealed that certain columns contained extremely long character strings (e.g., director up to 208 characters, cast up to 771 characters, and description up to 250 characters), which directly influenced the subsequent database schema design. The dataset was confirmed to have a total of 8,808 rows.</p>
                <p data-i18n="sub.data_gathering.text-5.3">The next step involved setting up the target database in <span>PostgreSQL</span> and defining the table structure. During schema creation, appropriate <span>VARCHAR</span> limits were set for all columns based on the <span>Excel</span> analysis to prevent truncation errors. Subsequently, the data was imported into the <span>PostgreSQL</span> environment via <span>PG Admin 4</span>. An initial import attempt failed due to an insufficient <span>VARCHAR</span> limit defined for the 'listed in' (genre) column. This was resolved by using the <span>DROP TABLE</span> command, increasing the column limit (from 25 to 100 characters), recreating the table, and re-running the import process successfully. This ensured the availability of all 8,807 final records for analysis.</p>
              </div>
          </div>
        </div>
      </div>

      <div class="section accordion-level-1" id="schema">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="sub.schema">Schema</p>
        </div>

        <div class="section-content">
          <pre><code class="language-sql">
  DROP TABLE IF EXISTS netflix;
  CREATE TABLE netflix
  (
    show_id 		VARCHAR(6),
    type 			VARCHAR(10),
    title 			VARCHAR(150),
    director 		VARCHAR(208), 
    casts 			VARCHAR(1000),
    country 		VARCHAR(150),
    date_added 		VARCHAR(50),
    release_year 	INT,
    rating 			VARCHAR(10),
    duration 		VARCHAR(15),
    listed_in 		VARCHAR(100),
    description		VARCHAR(250)
  );
          </code></pre>
        </div>
      </div>

      <div class="section accordion-level-1" id="solutions">
        <div class="section-header">
          <i class="ri-arrow-right-s-fill"></i>
          <p data-i18n="section.solutions">Solutions</p>
        </div>
            
        <div class="section-content">
          <div class="section accordion-level-2" id="schema-1">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.1">1. Count the number of Movies vs TV Shows</span>
                </div>
  
                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        type,
        COUNT(*) AS total_content
    FROM netflix
    GROUP BY type;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>type</th>
                                            <th>total_content</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Movie</td>
                                            <td>6131</td>
                                        </tr>
                                        <tr>
                                            <td>TV Show</td>
                                            <td>2676</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
          </div>
  
          <div class="section accordion-level-2" id="schema-2">
              <div class="section-header">
                  <i class="ri-arrow-right-s-fill"></i>
                  <span data-i18n="sub.solution.title-5.2">2. Find the most common rating for movies and TV shows</span>
              </div>

              <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        type,
        rating
    FROM
    (
        SELECT
            type,
            rating,
            COUNT(),
            RANK() OVER(PARTITION BY type ORDER BY COUNT() DESC) AS ranking
        FROM netflix
        GROUP BY 1, 2
    ) AS t1
    WHERE
        ranking = 1;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>type</th>
                                            <th>rating</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Movie</td>
                                            <td>TV-MA</td>
                                        </tr>
                                        <tr>
                                            <td>TV Show</td>
                                            <td>TV-MA</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-3">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.3">3. List all movies released in a specific year (e.g., 2020)</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        type = 'Movie'
        AND
        release_year = 2020;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>title</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s1</td>
                                            <td>Movie</td>
                                            <td>Dick Johnson Is Dead</td>
                                        </tr>
                                        <tr>
                                            <td>s17</td>
                                            <td>Movie</td>
                                            <td>Europe's Most Dangerous Man: Otto Skorzeny in Spain</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s7595</td>
                                            <td>Movie</td>
                                            <td>Norm of the North: Family Vacation</td>
                                        </tr>
                                        <tr>
                                            <td>s8100</td>
                                            <td>Movie</td>
                                            <td>Straight Up</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 517</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-4">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.4">4. Find the top 5 countries with the most content on Netflix</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        TRIM(UNNEST(STRING_TO_ARRAY(country, ','))) AS new_country,
        COUNT(show_id) AS total_content
    FROM netflix
    GROUP BY 1
    ORDER BY 2 DESC
    LIMIT 5;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>new_country</th>
                                            <th>total_content</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>United States</td>
                                            <td>3690</td>
                                        </tr>
                                        <tr>
                                            <td>India</td>
                                            <td>1046</td>
                                        </tr>
                                        <tr>
                                            <td>United Kingdom</td>
                                            <td>806</td>
                                        </tr>
                                        <tr>
                                            <td>Canada</td>
                                            <td>445</td>
                                        </tr>
                                        <tr>
                                            <td>France</td>
                                            <td>393</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-5">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.5">5. Identify the longest movie</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        type,
        title,
        SPLIT_PART (duration, ' ', 1) :: INT 
    FROM
        netflix
    WHERE type IN ('Movie') AND duration IS NOT NULL
    ORDER BY 3 DESC
    LIMIT 1;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                <thead>
                                    <tr>
                                        <th>type</th>
                                        <th>title</th>
                                        <th>split_part</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Movie</td>
                                        <td>Black Mirror: Bandersnatch</td>
                                        <td>312</td>
                                    </tr>
                                </tbody>
                            </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-6">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.6">6. Find content added in the last 5 years</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        TO_DATE(date_added, 'Month DD, YYYY') >= CURRENT_DATE - INTERVAL '5 years';
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>date_added</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s1</td>
                                            <td>Movie</td>
                                            <td>September 25, 2021</td>
                                        </tr>
                                        <tr>
                                            <td>s2</td>
                                            <td>TV Show</td>
                                            <td>September 24, 2021</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s8462</td>
                                            <td>Movie</td>
                                            <td>January 1, 2021</td>
                                        </tr>
                                        <tr>
                                            <td>s8507</td>
                                            <td>Movie</td>
                                            <td>November 13, 2020</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 1782</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-7">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.7">7. Find all the movies/TV shows by director 'Rajiv Chilaka'</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE director LIKE '%Rajiv Chilaka%';
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>director</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s407</td>
                                            <td>Movie</td>
                                            <td>Rajiv Chilaka</td>
                                        </tr>
                                        <tr>
                                            <td>s408</td>
                                            <td>Movie</td>
                                            <td>Rajiv Chilaka</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s6465</td>
                                            <td>Movie</td>
                                            <td>Rajiv Chilaka, Binayak Das</td>
                                        </tr>
                                        <tr>
                                            <td>s6646</td>
                                            <td>Movie</td>
                                            <td>Rajiv Chilaka</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 22</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-8">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.8">8. List all TV shows with more than 5 seasons</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        type = 'TV Show'
        AND
        SPLIT_PART(duration, ' ', 1)::numeric > 5;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>duration</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s9</td>
                                            <td>TV Show</td>
                                            <td>9 Seasons</td>
                                        </tr>
                                        <tr>
                                            <td>s56</td>
                                            <td>TV Show</td>
                                            <td>6 Seasons</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s8558</td>
                                            <td>TV Show</td>
                                            <td>7 Seasons</td>
                                        </tr>
                                        <tr>
                                            <td>s8711</td>
                                            <td>TV Show</td>
                                            <td>8 Seasons</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 99</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-9">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.9">9. Count the number of content items in each genre</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT 
        TRIM(UNNEST(STRING_TO_ARRAY(listed_in, ','))) AS genre,
        COUNT(show_id) AS total_content
    FROM netflix
    GROUP BY 1
    ORDER BY 2 DESC;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>genre</th>
                                            <th>total_content</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>International Movies</td>
                                            <td>2752</td>
                                        </tr>
                                        <tr>
                                            <td>Dramas</td>
                                            <td>2427</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>Classic & Cult TV</td>
                                            <td>28</td>
                                        </tr>
                                        <tr>
                                            <td>TV Shows</td>
                                            <td>16</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 42</td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-10">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.10">10. Find each year and the average numbers of content release in India on netflix. return top 5 year with highest avg content release</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        EXTRACT(YEAR FROM TO_DATE(date_added, 'Month DD, YYYY')) AS year,
        COUNT(*) AS yearly_content,
        ROUND(
            COUNT(*)::numeric /
            (SELECT COUNT(*) FROM netflix WHERE country ILIKE '%india%')::numeric * 100,
            2
        ) AS avg_content_per_year
    FROM netflix
    WHERE country ILIKE '%india%'
    GROUP BY 1
    ORDER BY 3 DESC;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>year</th>
                                            <th>yearly_content</th>
                                            <th>avg_content_per_year</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2018</td>
                                            <td>349</td>
                                            <td>33.37</td>
                                        </tr>
                                        <tr>
                                            <td>2019</td>
                                            <td>218</td>
                                            <td>20.84</td>
                                        </tr>
                                        <tr>
                                            <td>2020</td>
                                            <td>199</td>
                                            <td>19.02</td>
                                        </tr>
                                        <tr>
                                            <td>2017</td>
                                            <td>162</td>
                                            <td>15.49</td>
                                        </tr>
                                        <tr>
                                            <td>2021</td>
                                            <td>105</td>
                                            <td>10.04</td>
                                        </tr>
                                        <tr>
                                            <td>2016</td>
                                            <td>13</td>
                                            <td>1.24</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-11">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.11">11. List all movies that are documentaries</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        listed_in LIKE '%Documentaries%';
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>listed_in</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s1</td>
                                            <td>Movie</td>
                                            <td>Documentaries</td>
                                        </tr>
                                        <tr>
                                            <td>s17</td>
                                            <td>Movie</td>
                                            <td>Documentaries, International Movies</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s8757</td>
                                            <td>Movie</td>
                                            <td>Documentaries, Music & Musicals</td>
                                        </tr>
                                        <tr>
                                            <td>s8764</td>
                                            <td>Movie</td>
                                            <td>Documentaries</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 869</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-12">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.12">12. Find all content without a director</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        director IS NULL;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>director</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s2</td>
                                            <td>TV Show</td>
                                            <td>[null]</td>
                                        </tr>
                                        <tr>
                                            <td>s4</td>
                                            <td>TV Show</td>
                                            <td>[null]</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>s8801</td>
                                            <td>TV Show</td>
                                            <td>[null]</td>
                                        </tr>
                                        <tr>
                                            <td>s8804</td>
                                            <td>TV Show</td>
                                            <td>[null]</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 2634</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-13">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.13">13. Find how many movies actor 'Salman Khan' appeared in last 10 years</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT * FROM netflix
    WHERE
        casts ILIKE '%Salman Khan%'
        AND
        release_year > EXTRACT(YEAR FROM CURRENT_DATE) - 10;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>show_id</th>
                                            <th>type</th>
                                            <th>casts</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>s2757</td>
                                            <td>Movie</td>
                                            <td>Lorena Franco, Bijesh Jayarajan, Neet Chowdhary, Rajeev Gaursingh, Karran Jeet, Rajesh Sharma, Gautam Kurup, Poonam Mathur, Salman Khan, Manish Devkush</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-14">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.14">14. Find the top 10 actors who have appeared in the highest number of movies produced in India</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    SELECT
        TRIM(UNNEST(STRING_TO_ARRAY(casts, ','))) AS actors,
        COUNT(*) AS total_content
    FROM netflix
    WHERE country ILIKE '%india'
    GROUP BY 1
    ORDER BY 2 DESC
    LIMIT 10;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>actors</th>
                                            <th>total_content</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Anupam Kher</td>
                                            <td>40</td>
                                        </tr>
                                        <tr>
                                            <td>Shah Rukh Khan</td>
                                            <td>33</td>
                                        </tr>
                                        <tr>
                                            <td>...</td>
                                            <td>...</td>
                                        </tr>
                                        <tr>
                                            <td>Kareena Kapoor</td>
                                            <td>24</td>
                                        </tr>
                                        <tr>
                                            <td>Ajay Devgn</td>
                                            <td>21</td>
                                        </tr>
                                        <tr>
                                            <td>Total rows: 10</td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="section accordion-level-2" id="schema-15">
                <div class="section-header">
                    <i class="ri-arrow-right-s-fill"></i>
                    <span data-i18n="sub.solution.title-5.15">15. Categorize the content based on the presence of the keywords 'kill' and 'violence' in the description field. Label content containing these keywords as 'Bad' and all other content as 'Good'. Count how many items fall into each category</span>
                </div>

                <div class="section-content">
                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.code">Code</span>
                        </div>
            
                        <div class="section-content">
                            <pre><code class="language-sql">
    WITH new_table
    AS
    (
        SELECT *,
            CASE
            WHEN
                description ILIKE '%kill%'
                OR 
                description ILIKE '%violence%'
            THEN
                'Bad'
            ELSE
                'Good'
            END category
        FROM netflix
    )
    SELECT
        category,
        COUNT(*) AS total_content
    FROM new_table
    GROUP BY 1;
                            </code></pre>
                        </div>
                    </div>

                    <div class="section accordion-level-3" id="schema-1">
                        <div class="section-header">
                            <i class="ri-arrow-right-s-fill"></i>
                            <span data-i18n="sub.solution.result">Result</span>
                        </div>
            
                        <div class="section-content">
                            <div class="schema-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>category</th>
                                            <th>total_content</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Good</td>
                                            <td>8465</td>
                                        </tr>
                                        <tr>
                                            <td>Bad</td>
                                            <td>342</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      </div>

      <!-- Navigation Bar -->
      <a href="../index.html" class="navigation-card">
          <i class="ri-arrow-left-fill"></i>
          <p data-i18n="navigation.homepage">Homepage</p>
      </a>
    </main>
  </div>
  <script type="module" src="../assets/js/reports.js"></script>
  <script src="../assets/js/main.js"></script>
  <script src="../assets/js/language-handler.js"></script>
  <script src="../assets/js/languages.js"></script>
</body>
</html>